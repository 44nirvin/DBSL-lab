LAB EXERCISE: 
Implement the following Queries on UNIVERSITY Database. 
Group By: 
1. Find the number of students in each course.

SQL> select t.course_id, c.title, count(s.id) as student from takes t
join student s on s.id=t.id
join course c on c.course_id=t.course_id
group by t.course_id,c.title;
 
2. Find those departments where the average number of students are greater than 10. 
SQL> select c.dept_name from course c
join takes t on c.course_id= t.course_id
group by c.dept_name
having count( distinct t.id) >10;


3. Find the total number of courses in each department. 

select dept_name, count(course_id) from course
group by dept_name;

4. Find the names and average salaries of all departments whose average salary is 
greater than 42000. 

select avg(salary) as avgsal from instructor 
group by dept_name
having avg(salary) >42000;

5. Find the enrolment of each section that was offered in Spring 2009. 
this is wrong, fix it.
select sec_id, count(distinct id) as enrolment from takes t
where semester='Spring' and year=2009
group by sec_id;

Ordering the display of Tuples (Use ORDER BY ASC/DESC): 
6. List all the courses with prerequisite courses, then display course id in increasing 
order. 
7. Display the details of instructors sorting the salary in decreasing order.  
Derived Relations: 
8. Find the maximum total salary across the departments. 
9. Find the average instructors’ salaries of those departments where the average 
salary is greater than 42000. 
10. Find the sections that had the maximum enrolment in Spring 2010 
11. Find the names of all instructors who teach all students that belong to ‘CSE’ 
department. 
12. Find the average salary of those department where the average salary is greater 
than 50000 and total number of instructors in the department are more than 5. 
With Clause: 
13. Find all departments with the maximum budget. 
14. Find all departments where the total salary is greater than the average of the total 
salary at all departments. 
(Use ROLLBACK (and SAVEPOINT) to undo the effect of any modification on 
database before COMMIT) 
15. Transfer all the students from CSE department to IT department. 
16. Increase salaries of instructors whose salary is over $100,000 by 3%, and all  
others receive a 5% raise 